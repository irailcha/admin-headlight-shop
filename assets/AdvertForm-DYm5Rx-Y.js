import{e as v,f as n,h as N,i as u,k as g,u as b,r as y,j as e,F,l as O,n as i,E as a,I as k,o as U}from"./index-lv0lobN2.js";const q=v().shape({mark:n().required("Це поле обов'язкове"),model:n().required("Це поле обов'язкове"),state:n().required("Це поле обов'язкове"),typeOfLamps:n().required("Це поле обов'язкове"),side:n().required("Це поле обов'язкове"),isOriginal:N().required("Це поле обов'язкове"),partNumber:n().required("Це поле обов'язкове"),price:u().required("Це поле обов'язкове").min(0,"Ціна не може бути від'ємною"),photo:g().min(1,"Має бути хоча б одне фото").test("fileFormat","Файли мають бути у форматі JPEG, WEBP або PNG",l=>l.every(c=>["image/jpeg","image/png","image/webp"].includes(c.type))).test("fileSize","Розмір файлу не має перевищувати 5 МБ",l=>l.every(c=>c.size<=5*1024*1024)),videoUrl:n().url("Невірне посилання на відео"),description:n().required("Це поле обов'язкове")}),L=()=>{const l=b(),[c,d]=y.useState([]),h=async s=>{const r=new FormData;r.append("mark",s.mark),r.append("model",s.model),r.append("state",s.state),r.append("typeOfLamps",s.typeOfLamps),r.append("isOriginal",s.isOriginal),r.append("side",s.side),r.append("partNumber",s.partNumber),r.append("price",s.price),r.append("description",s.description),s.photo.forEach(o=>{r.append("photo",o)}),s.videoUrl&&r.append("videoUrl",s.videoUrl);try{await l(U(r)),alert("Оголошення додано!")}catch{alert("Сталася помилка при додаванні оголошення")}},x=s=>{d(r=>r.filter((o,t)=>t!==s))},j=s=>{if(!s.length)return"Має бути хоча б одне фото";for(let r of s){if(!["image/jpeg","image/png","image/webp"].includes(r.type))return"Файли мають бути у форматі JPEG, WEBP або PNG";if(r.size>5*1024*1024)return"Розмір файлу не має перевищувати 5 МБ"}};return e.jsx("section",{className:"form-container",children:e.jsx(F,{initialValues:{mark:"",model:"",state:"",typeOfLamps:"",side:"",isOriginal:!1,partNumber:"",price:0,photo:[],videoUrl:"",description:""},validationSchema:q,onSubmit:h,children:({setFieldValue:s,setErrors:r})=>e.jsxs(O,{children:[e.jsx("h2",{className:"form-title",children:"Створити оголошення"}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"mark",children:"Марка"}),e.jsx(i,{name:"mark",type:"text"}),e.jsx(a,{name:"mark",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"model",children:"Модель"}),e.jsx(i,{name:"model",type:"text"}),e.jsx(a,{name:"model",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"state",children:"Стан"}),e.jsxs(i,{as:"select",name:"state",children:[e.jsx("option",{value:"Нова",children:"Нова"}),e.jsx("option",{value:"Вживана",children:"Вживана"})]}),e.jsx(a,{name:"state",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"typeOfLamps",children:"Тип ламп"}),e.jsx(i,{name:"typeOfLamps",type:"text"}),e.jsx(a,{name:"typeOfLamps",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"side",children:"Сторона"}),e.jsxs(i,{as:"select",name:"side",children:[e.jsx("option",{value:"Ліва",children:"Ліва"}),e.jsx("option",{value:"Права",children:"Права"}),e.jsx("option",{value:"Комплект",children:"Комплект"})]}),e.jsx(a,{name:"side",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"isOriginal",children:"Оригінальність"}),e.jsx(i,{type:"checkbox",name:"isOriginal"}),e.jsx(a,{name:"isOriginal",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"partNumber",children:"Номер деталі"}),e.jsx(i,{name:"partNumber",type:"text"}),e.jsx(a,{name:"partNumber",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"price",children:"Ціна"}),e.jsx(i,{name:"price",type:"number"}),e.jsx(a,{name:"price",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"photo",children:"Фото"}),e.jsxs("div",{className:"photo-field",children:[e.jsx("input",{className:"field-container__photo-field",name:"photo",type:"file",multiple:!0,onChange:o=>{const t=Array.from(o.currentTarget.files),p=j(t),f=t.map(m=>URL.createObjectURL(m));p?(s("photo",[]),r({photo:p})):(s("photo",t),d(m=>[...m,...f]))}}),e.jsx("div",{className:"photo-preview-container",children:c.map((o,t)=>e.jsxs("div",{className:"photo-item",children:[e.jsx("img",{src:o,alt:`Фото ${t+1}`,className:"photo-preview"}),e.jsx("button",{type:"button",onClick:()=>x(t),className:"remove-photo-button",children:e.jsx(k,{})})]},t))})]}),e.jsx(a,{name:"photo",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"videoUrl",children:"Посилання на відео"}),e.jsx(i,{name:"videoUrl",type:"url"}),e.jsx(a,{name:"videoUrl",component:"div",className:"error-message"})]}),e.jsxs("div",{className:"field-container",children:[e.jsx("label",{htmlFor:"description",children:"Опис"}),e.jsx(i,{name:"description",as:"textarea"}),e.jsx(a,{name:"description",component:"div",className:"error-message"})]}),e.jsx("button",{type:"submit",children:"Додати оголошення"})]})})})};export{L as default};
